<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Chuy·∫øn giao ‚Äì Foodbank Logistics Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- CSS giao di·ªán Community Leader -->
  <link rel="stylesheet" href="cl.css" />
  <!-- D√πng l·∫°i style admin cho layout trip -->
  <link rel="stylesheet" href="../for_admin/orders.css" />
  <link rel="stylesheet" href="../for_admin/trip.css" />

  <!-- Leaflet (OpenStreetMap) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
</head>
<body class="app">
  <!-- SIDEBAR CH√çNH CHO COMMUNITY LEADER -->
  <aside class="sidebar-main">
    <div class="sidebar-main-header">
      <div class="logo-circle">FB</div>
      <div>
        <div class="logo-title">Foodbank Hub</div>
        <div class="logo-sub">Community Leader</div>
      </div>
    </div>

    <!-- N√∫t hamburger mobile -->
    <button class="sidebar-hamburger" id="sidebarToggle">‚ò∞</button>

    <nav class="sidebar-main-nav" id="sidebarNav">
      <button class="nav-item" onclick="window.location.href='index.html'">
        T·ªïng quan
      </button>
      <button class="nav-item" onclick="window.location.href='survey.html'">
        Kh·∫£o s√°t nhu c·∫ßu
      </button>
      <button class="nav-item" onclick="window.location.href='request.html'">
        Y√™u c·∫ßu giao h√†ng
      </button>
      <button class="nav-item" onclick="window.location.href='orders.html'">
        ƒê∆°n h√†ng trong khu
      </button>
      <!-- Trang hi·ªán t·∫°i -->
      <button class="nav-item nav-item-active">
        üó∫Ô∏è Chuy·∫øn giao
      </button>
    </nav>

    <div class="sidebar-main-user">
      <div class="avatar-circle">CL</div>
      <div>
        <div class="user-name">CL Nguy·ªÖn A</div>
        <div class="user-role">Community Leader</div>
      </div>
    </div>
  </aside>

  <!-- LAYOUT TRIP: gi·ªëng for_admin nh∆∞ng b·ªè n√∫t Add trip -->
  <main class="trip-layout">
    <!-- SIDEBAR TRIP (C·ªòT TH·ª® 2) -->
    <section class="trip-sidebar">
      <header class="trip-sidebar-header">
        <div>
          <h1>Tracking trips</h1>
          <p>Theo d√µi c√°c chuy·∫øn giao h√†ng b·∫±ng xe m√°y</p>
        </div>
        <!-- ƒê√É B·ªé n√∫t Add trip ƒë·ªÉ ch·ªâ c√≤n xem -->
      </header>

      <div class="trip-sidebar-filters">
        <div class="search-wrapper">
          <input
            id="tripSearch"
            class="input search-input"
            placeholder="T√¨m Trip ID, t√¨nh nguy·ªán vi√™n‚Ä¶"
          />
        </div>
        <div class="chips-row">
          <button class="chip chip-active" data-status="ALL">All</button>
          <button class="chip" data-status="Planned">Planned</button>
          <button class="chip" data-status="InProcess">In Process</button>
          <button class="chip" data-status="Completed">Completed</button>
          <button class="chip" data-status="Cancelled">Cancelled</button>
        </div>
      </div>

      <div id="tripList" class="trip-list">
        <!-- JS render danh s√°ch trip -->
      </div>
    </section>

    <!-- PANEL CHI TI·∫æT + MAP -->
    <section class="trip-detail">
      <!-- Thanh ti√™u ƒë·ªÅ Trip -->
      <header class="trip-detail-header">
        <div>
          <div class="trip-detail-label">ƒêang theo d√µi</div>
          <div class="trip-detail-title">
            Trip <span id="detailTripId">‚Äì</span>
            <span id="detailTripStatus" class="status-pill">‚Äì</span>
          </div>
        </div>
        <div class="trip-detail-actions">
          <button class="icon-btn" title="G·ªçi TNV">üìû</button>
          <button class="icon-btn" title="Chat">üí¨</button>
          <button class="icon-btn" title="Xem docs">üìÑ</button>
        </div>
      </header>

      <!-- N·ªôi dung chi ti·∫øt + map -->
      <div class="trip-detail-body">
        <!-- C·ªôt timeline + load info -->
        <div class="trip-timeline">
          <div class="timeline-tabs">
            <button class="tab tab-active" data-tab="tracking">Tracking</button>
            <button class="tab" data-tab="load">Load info</button>
          </div>

          <!-- Panel: Tracking (3 m·ªëc ch√≠nh) -->
          <div id="trackingPanel" class="timeline-panel">
            <ul class="timeline-list">
              <li class="timeline-item">
                <div class="timeline-dot timeline-dot-primary"></div>
                <div class="timeline-content">
                  <div class="timeline-title">Pick up</div>
                  <div id="pickupAddress" class="timeline-text"></div>
                  <div id="pickupTime" class="timeline-time"></div>
                </div>
              </li>
              <li class="timeline-item">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                  <div class="timeline-title">In sorting centre</div>
                  <div id="sortingAddress" class="timeline-text"></div>
                  <div id="sortingTime" class="timeline-time"></div>
                </div>
              </li>
              <li class="timeline-item">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                  <div class="timeline-title">Delivered</div>
                  <div id="deliveredAddress" class="timeline-text"></div>
                  <div id="deliveredTime" class="timeline-time"></div>
                </div>
              </li>
            </ul>

            <div class="trip-meta">
              <div><span>Volunteer:</span> <span id="detailVolunteer">‚Äì</span></div>
              <div><span>Campaign:</span> <span id="detailCampaign">‚Äì</span></div>
              <div><span>Warehouse:</span> <span id="detailWarehouse">‚Äì</span></div>
              <div><span>Distance:</span> <span id="detailDistance">‚Äì</span></div>
            </div>
          </div>

          <!-- Panel: Load info ‚Äì GPS log 2 ph√∫t/l·∫ßn -->
          <div id="loadInfoPanel" class="timeline-panel" style="display:none;">
            <div class="gps-header">
              <h3>L·ªô tr√¨nh chi ti·∫øt (GPS log)</h3>
              <span id="gpsSummary" class="gps-summary"></span>
            </div>

            <div class="gps-table-wrapper">
              <table class="gps-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Th·ªùi gian</th>
                    <th>Lat</th>
                    <th>Lng</th>
                    <th>ƒê·ªãa ch·ªâ</th>
                    <th>T·ªëc ƒë·ªô (km/h)</th>
                    <th>Tr·∫°ng th√°i</th>
                  </tr>
                </thead>
                <tbody id="gpsLogTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- C·ªôt b·∫£n ƒë·ªì -->
        <div class="trip-map-wrapper">
          <div class="map-toolbar">
            <button class="map-btn map-btn-active">Map</button>
          </div>
          <div id="map" class="map"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- JS logic Trip (view-only) -->
  <script src="trip.js"></script>

  <!-- Toggle sidebar mobile -->
  <script>
    (function () {
      const toggleBtn = document.getElementById("sidebarToggle");
      const nav = document.getElementById("sidebarNav");
      if (toggleBtn && nav) {
        toggleBtn.addEventListener("click", () => {
          nav.classList.toggle("show");
        });
      }
    })();
  </script>
</body>
</html>
