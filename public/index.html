<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Foodbank Logistics Hub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- CSS -->
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/dashboard.css" />
    <link rel="stylesheet" href="css/drawer.css" />

    <!-- Leaflet (OpenStreetMap) -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
  </head>
  <body>
    <!-- Toast -->
    <div id="app-toast" class="toast"></div>

    <!-- ============ AUTH: ch·ªçn role + login/register ============ -->
    <section id="auth-screen" class="auth-screen">
      <div class="auth-card">
        <div class="auth-card__header">
          <div class="auth-logo">
            <span class="auth-logo__icon">FB</span>
            <div>
              <div class="auth-logo__name">Foodbank</div>
              <div class="auth-logo__sub">Logistics Hub</div>
            </div>
          </div>
          <h1 class="auth-title">Ch·ªçn vai tr√≤ & ƒëƒÉng nh·∫≠p</h1>
          <p class="auth-subtitle">
            H·ªá th·ªëng h·ªó tr·ª£ v·∫≠n chuy·ªÉn c·ª©u tr·ª£ t·ª´ kho Foodbank ƒë·∫øn h·ªô gia ƒë√¨nh
            y·∫øu th·∫ø.
          </p>
        </div>

        <!-- Ch·ªçn role -->
        <div class="role-picker">
          <button
            class="role-pill role-pill--active"
            data-role-card
            data-role="admin"
          >
            Admin
          </button>
          <button class="role-pill" data-role-card data-role="community">
            Community Leader
          </button>
          <button class="role-pill" data-role-card data-role="volunteer">
            Volunteer
          </button>
          <button class="role-pill" data-role-card data-role="household">
            Vulnerable Household
          </button>
        </div>

        <!-- Tabs -->
        <div class="auth-tabs">
          <button
            class="auth-tab auth-tab--active"
            type="button"
            data-auth-tab="login"
          >
            ƒêƒÉng nh·∫≠p
          </button>
          <button class="auth-tab" type="button" data-auth-tab="register">
            ƒêƒÉng k√Ω t√†i kho·∫£n
          </button>
        </div>

        <!-- ƒêƒÉng nh·∫≠p -->
        <form id="auth-login-form" class="auth-form">
          <div class="form__group">
            <label for="login-username">S·ªë ƒëi·ªán tho·∫°i</label>
            <input
              id="login-username"
              name="username"
              type="tel"
              placeholder="VD: 0909 000 001"
              required
            />
          </div>
          <div class="form__group">
            <label for="login-password">M·∫≠t kh·∫©u</label>
            <input
              id="login-password"
              name="password"
              type="password"
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              required
            />
          </div>
          <p id="auth-login-hint" class="auth-hint"></p>
          <button type="submit" class="btn btn--primary btn--fullwidth">
            ƒêƒÉng nh·∫≠p
          </button>
        </form>

        <!-- ƒêƒÉng k√Ω -->
        <form
          id="auth-register-form"
          class="auth-form auth-form--hidden"
          autocomplete="off"
        >
          <div class="form__group">
            <label for="reg-fullname">H·ªç v√† t√™n</label>
            <input
              id="reg-fullname"
              name="fullName"
              type="text"
              placeholder="VD: Nguy·ªÖn VƒÉn A"
              required
            />
          </div>
          <div class="form__group">
            <label for="reg-username">S·ªë ƒëi·ªán tho·∫°i</label>
            <input
              id="reg-username"
              name="username"
              type="tel"
              placeholder="VD: 0909 000 099"
              required
            />
          </div>
          <div class="form__group">
            <label for="reg-password">M·∫≠t kh·∫©u</label>
            <input
              id="reg-password"
              name="password"
              type="password"
              placeholder="T·ªëi thi·ªÉu 4 k√Ω t·ª±"
              required
            />
          </div>

          <!-- Th√¥ng tin theo role -->
          <div class="form__group" data-role-section="volunteer">
            <label for="reg-volunteer-id">Volunteer ID</label>
            <input
              id="reg-volunteer-id"
              name="volunteerId"
              type="text"
              placeholder="VD: VL_9100..."
            />
          </div>

          <div class="form__group" data-role-section="household">
            <label for="reg-household-id">Household ID</label>
            <input
              id="reg-household-id"
              name="householdId"
              type="text"
              placeholder="VD: HH_9100..."
            />
          </div>

          <div class="form__group" data-role-section="community">
            <label for="reg-area-id">Kho / Khu v·ª±c ph·ª• tr√°ch</label>
            <input
              id="reg-area-id"
              name="areaId"
              type="text"
              placeholder="VD: WH_0002"
            />
          </div>

          <button type="submit" class="btn btn--primary btn--fullwidth">
            ƒêƒÉng k√Ω & v√†o h·ªá th·ªëng
          </button>
        </form>
      </div>
    </section>

    <!-- ============ APP CH√çNH ============ -->
    <div id="main-app" class="app-shell app-shell--hidden">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar__header">
          <div class="sidebar-logo">
            <span class="sidebar-logo__icon">FB</span>
            <div>
              <div class="sidebar-logo__name">Foodbank</div>
              <div class="sidebar-logo__sub">Logistics Hub</div>
            </div>
          </div>
        </div>

        <nav class="sidebar-nav">
          <a
            href="#"
            class="nav-item nav-item--active"
            data-view-target="view-orders"
            data-visible-roles="admin,volunteer,community,household"
          >
            <span class="nav-item__icon">üì¶</span>
            <span class="nav-item__label">ƒê∆°n h√†ng</span>
          </a>

          <a
            href="#"
            class="nav-item"
            data-view-target="view-campaigns"
            data-visible-roles="admin,community"
          >
            <span class="nav-item__icon">üéØ</span>
            <span class="nav-item__label">Campaign</span>
          </a>

          <a
            href="#"
            class="nav-item"
            data-view-target="view-volunteers"
            data-visible-roles="admin,volunteer"
          >
            <span class="nav-item__icon">ü§ù</span>
            <span class="nav-item__label">T√¨nh nguy·ªán vi√™n</span>
          </a>

          <a
            href="#"
            class="nav-item"
            data-view-target="view-community"
            data-visible-roles="admin,community"
          >
            <span class="nav-item__icon">üè†</span>
            <span class="nav-item__label">T·ªï d√¢n ph·ªë</span>
          </a>

          <a
            href="#"
            class="nav-item"
            data-view-target="view-warehouses"
            data-visible-roles="admin"
          >
            <span class="nav-item__icon">üè¨</span>
            <span class="nav-item__label">Kho & ƒëi·ªÉm t·∫≠p k·∫øt</span>
          </a>

          <a
            href="#"
            class="nav-item"
            data-view-target="view-incidents"
            data-visible-roles="admin,volunteer,community"
          >
            <span class="nav-item__icon">‚ö†Ô∏è</span>
            <span class="nav-item__label">S·ª± c·ªë & h·ªó tr·ª£</span>
          </a>
        </nav>

        <div class="sidebar__footer">
          <button id="btn-logout" class="btn btn--ghost btn--fullwidth">
            ƒêƒÉng xu·∫•t
          </button>
        </div>
      </aside>

      <!-- Main -->
      <main class="main">
        <!-- Topbar -->
        <header class="topbar">
          <div class="topbar__left">
            <div class="topbar__path">Dashboard</div>
            <h1 id="topbar-title" class="topbar__title">
              Foodbank Logistics Hub
            </h1>
            <p id="topbar-subtitle" class="topbar__subtitle">
              Theo d√µi lu·ªìng h√†ng t·ª´ kho Foodbank ƒë·∫øn h·ªô gia ƒë√¨nh y·∫øu th·∫ø.
            </p>
          </div>
          <div class="topbar__right">
            <div class="topbar-user">
              <div id="topbar-avatar" class="avatar avatar--small">FB</div>
              <div class="topbar-user__info">
                <div id="topbar-user-name" class="topbar-user__name">User</div>
                <div id="topbar-user-role" class="topbar-user__role">Role</div>
              </div>
            </div>
          </div>
        </header>

        <!-- ===== VIEW ƒê∆†N H√ÄNG ===== -->
        <section id="view-orders" class="view view--active">
          <div class="metrics-row">
            <div class="metric-card">
              <div id="metric-total-label" class="metric-card__label">
                T·ªïng ƒë∆°n h√¥m nay
              </div>
              <div id="metric-total" class="metric-card__value">0</div>
            </div>
            <div class="metric-card">
              <div class="metric-card__label">ƒêang giao</div>
              <div id="metric-intransit" class="metric-card__value">0</div>
            </div>
            <div class="metric-card">
              <div class="metric-card__label">ƒê√£ giao</div>
              <div id="metric-delivered" class="metric-card__value">0</div>
            </div>
            <div class="metric-card">
              <div class="metric-card__label">Th·∫•t b·∫°i</div>
              <div id="metric-failed" class="metric-card__value">0</div>
            </div>
          </div>

          <!-- Toolbar -->
          <div class="toolbar">
            <div class="tabs">
              <button class="tab tab--active" data-status="all">T·∫•t c·∫£</button>
              <button class="tab" data-status="in-transit">ƒêang giao</button>
              <button class="tab" data-status="delivered">ƒê√£ giao</button>
              <button class="tab" data-status="upcoming">Ch·ªù l·∫•y</button>
              <button class="tab" data-status="failed">Th·∫•t b·∫°i</button>
            </div>

            <div class="toolbar__right">
              <div class="search-box">
                <span class="search-box__icon">üîç</span>
                <input
                  type="text"
                  placeholder="T√¨m Order / Volunteer / Campaign..."
                />
              </div>

              <select class="select select--order-sort">
                <option value="eta-asc">S·∫Øp x·∫øp: G·∫ßn ƒë·∫øn h·∫°n giao</option>
                <option value="created-desc">M·ªõi t·∫°o tr∆∞·ªõc</option>
                <option value="priority-asc">∆Øu ti√™n cao tr∆∞·ªõc</option>
              </select>

              <label class="btn btn--ghost">
                <input
                  type="file"
                  id="excel-input"
                  accept=".xlsx,.xls"
                  hidden
                />
                Import Excel
              </label>

              <button
                id="btn-open-create-order"
                class="btn btn--primary"
                type="button"
              >
                + T·∫°o y√™u c·∫ßu ƒë∆°n h√†ng
              </button>
              <button
                id="btn-open-create-campaign"
                class="btn btn--secondary"
                type="button"
              >
                + T·∫°o campaign m·ªõi
              </button>
            </div>
          </div>

          <div class="layout-two-cols">
            <!-- LIST ORDERS + TRIPS -->
            <section class="panel panel--orders">
              <h2 class="panel__title">Danh s√°ch ƒë∆°n h√†ng</h2>
              <div class="table-wrapper">
                <table class="table table--orders">
                  <thead>
                    <tr>
                      <th>Order ID</th>
                      <th>Tr·∫°ng th√°i</th>
                      <th>Campaign</th>
                      <th>Warehouse ‚Üí Household</th>
                      <th>T√¨nh nguy·ªán vi√™n</th>
                      <th>Created</th>
                      <th>ETA</th>
                    </tr>
                  </thead>
                  <tbody id="order-table-body"></tbody>
                </table>
              </div>

              <h2 class="panel__title panel__title--sub">
                Trip / tuy·∫øn giao hi·ªán t·∫°i
              </h2>
              <div id="trip-list" class="trip-list"></div>
            </section>

            <!-- MAP + ROUTE DETAIL -->
            <section class="panel panel--map">
              <div class="panel__header">
                <div>
                  <h2 class="panel__title">B·∫£n ƒë·ªì & h√†nh tr√¨nh</h2>
                  <div class="panel__subtitle">
                    ƒêang theo d√µi:
                    <span id="route-current-order">Ch∆∞a ch·ªçn ƒë∆°n / trip</span> ‚Äì
                    Route <span id="route-current-id">-</span>
                  </div>
                </div>
                <div class="map-panel__view-toggle">
                  <button class="chip chip--active">Map</button>
                  <button class="chip">Satellite</button>
                  <button class="chip">Layers</button>
                </div>
              </div>

              <div id="fb-map" class="map"></div>

              <div class="map-panel__tooltip">
                <h4 id="map-tooltip-title">
                  Ch·ªçn m·ªôt ƒë∆°n h√†ng ho·∫∑c trip ·ªü c·ªôt b√™n tr√°i
                </h4>
                <p id="map-tooltip-body">
                  Th√¥ng tin warehouse, ƒë·ªãa ch·ªâ giao, ETA s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y.
                </p>
              </div>

              <section class="route-info">
                <h3>Th√¥ng tin Route / Trip</h3>
                <dl class="route-info__grid">
                  <div>
                    <dt>Route / Trip ID</dt>
                    <dd id="route-info-id">-</dd>
                  </div>
                  <div>
                    <dt>Volunteer</dt>
                    <dd id="route-info-volunteer-id">-</dd>
                  </div>
                  <div>
                    <dt>Campaign</dt>
                    <dd id="route-info-campaign-id">-</dd>
                  </div>
                  <div>
                    <dt>Warehouse</dt>
                    <dd id="route-info-warehouse-id">-</dd>
                  </div>
                  <div>
                    <dt>B·∫Øt ƒë·∫ßu</dt>
                    <dd id="route-info-start-time">-</dd>
                  </div>
                  <div>
                    <dt>T·ªïng qu√£ng ƒë∆∞·ªùng</dt>
                    <dd id="route-info-distance">-</dd>
                  </div>
                </dl>

                <h4>Checkpoint (GPSTracking_Log)</h4>
                <ul id="checkpoint-list" class="checkpoint-list"></ul>

                <h4>Danh s√°ch g√≥i h√†ng trong ƒë∆°n</h4>
                <div class="table-wrapper">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>M√£ g√≥i</th>
                        <th>T√™n h√†ng</th>
                        <th>Nh√≥m</th>
                        <th>S·ªë l∆∞·ª£ng</th>
                        <th>ƒê∆°n v·ªã</th>
                        <th>Kh·ªëi l∆∞·ª£ng (kg)</th>
                      </tr>
                    </thead>
                    <tbody id="order-items-body"></tbody>
                  </table>
                </div>
              </section>
            </section>
          </div>
        </section>

        <!-- ===== VIEW CAMPAIGNS ===== -->
        <section id="view-campaigns" class="view">
          <div class="panel">
            <h2 class="panel__title">Campaign c·ª©u tr·ª£</h2>
            <p class="panel__subtitle">
              Danh s√°ch c√°c chi·∫øn d·ªãch h·ªó tr·ª£, khu v·ª±c v√† tr·∫°ng th√°i.
            </p>
            <div class="table-wrapper">
              <table class="table">
                <thead>
                  <tr>
                    <th>Campaign ID</th>
                    <th>T√™n chi·∫øn d·ªãch</th>
                    <th>Khu v·ª±c</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>B·∫Øt ƒë·∫ßu</th>
                    <th>K·∫øt th√∫c</th>
                  </tr>
                </thead>
                <tbody id="campaign-table-body"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- C√°c view kh√°c: placeholder -->
        <section id="view-volunteers" class="view">
          <div class="panel">
            <h2 class="panel__title">T√¨nh nguy·ªán vi√™n</h2>
          </div>
        </section>

        <section id="view-community" class="view">
          <div class="panel">
            <h2 class="panel__title">T·ªï d√¢n ph·ªë & H·ªô gia ƒë√¨nh</h2>
          </div>
        </section>

        <section id="view-warehouses" class="view">
          <div class="panel">
            <h2 class="panel__title">Kho & ƒêi·ªÉm t·∫≠p k·∫øt</h2>
          </div>
        </section>

        <section id="view-incidents" class="view">
          <div class="panel">
            <h2 class="panel__title">S·ª± c·ªë & H·ªó tr·ª£</h2>
          </div>
        </section>
      </main>
    </div>

    <!-- ===== Overlay & Drawer ===== -->
    <div id="drawer-overlay" class="drawer-overlay"></div>

    <!-- Drawer: t·∫°o ƒë∆°n -->
    <aside id="drawer-order" class="drawer">
      <div class="drawer__header">
        <h2 class="drawer__title">T·∫°o y√™u c·∫ßu ƒë∆°n h√†ng</h2>
        <button id="drawer-order-close" class="icon-btn" type="button">‚úï</button>
      </div>
      <div class="drawer__body">
        <p class="drawer__subtitle">
          Nh·∫≠p th√¥ng tin ƒë∆°n, h·ªá th·ªëng s·∫Ω ph√¢n tuy·∫øn cho t√¨nh nguy·ªán vi√™n.
        </p>

        <form id="create-order-form" class="form">
          <div class="form__group">
            <label for="order_id">Order ID *</label>
            <input
              type="text"
              id="order_id"
              name="order_id"
              placeholder="VD: 25ACDB99"
              required
            />
          </div>

          <div class="form__group">
            <label for="status">Tr·∫°ng th√°i ban ƒë·∫ßu</label>
            <select id="status" name="status">
              <option value="Upcoming">Upcoming (Ch·ªù l·∫•y)</option>
              <option value="InTransit">InTransit (ƒêang giao)</option>
              <option value="Delivered">Delivered (ƒê√£ giao)</option>
              <option value="Failed">Failed (Th·∫•t b·∫°i)</option>
            </select>
          </div>

          <div class="form__group">
            <label for="campaign_id">Campaign ID</label>
            <input
              type="text"
              id="campaign_id"
              name="campaign_id"
              placeholder="VD: CP_2025001"
            />
          </div>

          <div class="form__group">
            <label for="warehouse_id">Warehouse ID</label>
            <input
              type="text"
              id="warehouse_id"
              name="warehouse_id"
              placeholder="VD: WH_0001"
            />
          </div>

          <div class="form__group">
            <label for="household_id">Household ID</label>
            <input
              type="text"
              id="household_id"
              name="household_id"
              placeholder="VD: HH_..."
            />
          </div>

          <div class="form__group">
            <label for="volunteer_id">Volunteer ID</label>
            <input
              type="text"
              id="volunteer_id"
              name="volunteer_id"
              placeholder="VD: VL_..."
            />
          </div>

          <div class="form__group">
            <label for="route_id">Route ID</label>
            <input
              type="text"
              id="route_id"
              name="route_id"
              placeholder="VD: RT_..."
            />
          </div>

          <div class="form__group form__group--inline">
            <div>
              <label for="priority">ƒê·ªô ∆∞u ti√™n</label>
              <select id="priority" name="priority">
                <option value="">--</option>
                <option value="1">1 (Cao)</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5 (Th·∫•p)</option>
              </select>
            </div>
            <div>
              <label for="packages_count">S·ªë ki·ªán</label>
              <input
                type="number"
                id="packages_count"
                name="packages_count"
                min="1"
                placeholder="VD: 5"
              />
            </div>
          </div>

          <div class="form__group">
            <label for="total_weight_kg">T·ªïng kh·ªëi l∆∞·ª£ng (kg)</label>
            <input
              type="number"
              step="0.1"
              id="total_weight_kg"
              name="total_weight_kg"
              placeholder="VD: 45"
            />
          </div>

          <div class="form__group form__group--inline">
            <div>
              <label for="created_time">Created time</label>
              <input
                type="datetime-local"
                id="created_time"
                name="created_time"
              />
            </div>
            <div>
              <label for="eta_time">ETA</label>
              <input type="datetime-local" id="eta_time" name="eta_time" />
            </div>
          </div>

          <div class="form__group">
            <label for="notes">Ghi ch√∫</label>
            <textarea
              id="notes"
              name="notes"
              rows="3"
              placeholder="Ghi ch√∫ th√™m..."
            ></textarea>
          </div>

          <div class="drawer__footer">
            <button
              type="button"
              id="btn-cancel-create-order"
              class="btn btn--ghost"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn btn--primary">L∆∞u ƒë∆°n h√†ng</button>
          </div>
        </form>
      </div>
    </aside>

    <!-- Drawer: t·∫°o campaign -->
    <aside id="drawer-campaign" class="drawer">
      <div class="drawer__header">
        <h2 class="drawer__title">T·∫°o campaign m·ªõi</h2>
        <button id="drawer-campaign-close" class="icon-btn" type="button">
          ‚úï
        </button>
      </div>
      <div class="drawer__body">
        <p class="drawer__subtitle">
          ƒê·ªãnh nghƒ©a m·ªôt chi·∫øn d·ªãch c·ª©u tr·ª£ m·ªõi cho khu v·ª±c.
        </p>

        <form id="create-campaign-form" class="form">
          <div class="form__group">
            <label for="campaign_id_new">Campaign ID *</label>
            <input
              type="text"
              id="campaign_id_new"
              name="campaign_id"
              placeholder="VD: CP_2025010"
              required
            />
          </div>

          <div class="form__group">
            <label for="campaign_name">T√™n chi·∫øn d·ªãch</label>
            <input
              type="text"
              id="campaign_name"
              name="name"
              placeholder="VD: H·ªó tr·ª£ m√πa m∆∞a 2025"
            />
          </div>

          <div class="form__group">
            <label for="campaign_area">Khu v·ª±c</label>
            <input
              type="text"
              id="campaign_area"
              name="area"
              placeholder="VD: Q.8, Q. B√¨nh T√¢n..."
            />
          </div>

          <div class="form__group form__group--inline">
            <div>
              <label for="campaign_start">B·∫Øt ƒë·∫ßu</label>
              <input type="date" id="campaign_start" name="start_date" />
            </div>
            <div>
              <label for="campaign_end">K·∫øt th√∫c</label>
              <input type="date" id="campaign_end" name="end_date" />
            </div>
          </div>

          <div class="form__group">
            <label for="campaign_status">Tr·∫°ng th√°i</label>
            <select id="campaign_status" name="status">
              <option value="Active">Active</option>
              <option value="Planning">Planning</option>
              <option value="Closed">Closed</option>
            </select>
          </div>

          <div class="form__group">
            <label for="campaign_description">M√¥ t·∫£</label>
            <textarea
              id="campaign_description"
              name="description"
              rows="3"
              placeholder="M·ª•c ti√™u, ph·∫°m vi, ghi ch√∫..."
            ></textarea>
          </div>

          <div class="drawer__footer">
            <button
              type="button"
              id="btn-cancel-create-campaign"
              class="btn btn--ghost"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn btn--primary">
              L∆∞u campaign
            </button>
          </div>
        </form>
      </div>
    </aside>

    <!-- JS -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZCc="
      crossorigin=""
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
